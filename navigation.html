<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation AR - Direction Arrows</title>

    <!-- A-Frame and AR.js -->
    <script src='https://aframe.io/releases/1.3.0/aframe.min.js'></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

    <!-- Configuration (optional, will fall back to static destinations) -->
    <script src="config.js"></script>

    <!-- Navigation logic -->
    <script src="navigation.js"></script>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        #info-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            max-width: 300px;
        }

        #info-panel h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
        }

        #info-panel p {
            margin: 5px 0;
        }

        .instructions {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            text-align: center;
            z-index: 1000;
            max-width: 90%;
        }

        @media (max-width: 600px) {
            #info-panel {
                font-size: 12px;
                padding: 10px;
            }
        }
    </style>
</head>

<body>
    <!-- Info Panel -->
    <div id="info-panel">
        <h3>ðŸ§­ Navigation AR</h3>
        <p><strong>Status:</strong> <span id="status">Initializing...</span></p>
        <p><strong>Arrows:</strong> <span id="arrow-count">0</span></p>
        <p><strong>GPS:</strong> <span id="gps-status">Waiting...</span></p>
    </div>

    <!-- Instructions -->
    <div class="instructions">
        ðŸ‘† Tap on arrows for destination info<br>
        ðŸ”„ Move your device around to see all directions
    </div>

    <!-- AR Scene -->
    <a-scene
        vr-mode-ui="enabled: false"
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        cursor='rayOrigin: mouse; fuse: true; fuseTimeout: 500;'
        raycaster="objects: .clickable"
        renderer="logarithmicDepthBuffer: true; precision: medium;">

        <!-- Camera with GPS tracking -->
        <a-camera
            gps-camera="simulateLatitude: 0; simulateLongitude: 0; gpsMinDistance: 5"
            rotation-reader>
        </a-camera>

        <!-- Entities will be added dynamically by navigation.js -->
    </a-scene>

    <!-- Status update script -->
    <script>
        // Update status indicators
        window.addEventListener('gps-camera-update-position', (e) => {
            document.getElementById('gps-status').textContent =
                `${e.detail.position.latitude.toFixed(6)}, ${e.detail.position.longitude.toFixed(6)}`;
        });

        window.addEventListener('gps-entity-place-loaded', () => {
            const count = document.querySelectorAll('[gps-entity-place]').length;
            document.getElementById('arrow-count').textContent = count;
            document.getElementById('status').textContent = 'Ready';
        });

        // Hide instructions after 10 seconds
        setTimeout(() => {
            const instructions = document.querySelector('.instructions');
            if (instructions) {
                instructions.style.transition = 'opacity 1s';
                instructions.style.opacity = '0';
                setTimeout(() => instructions.remove(), 1000);
            }
        }, 10000);
    </script>
</body>
</html>
